---
title: Nginx
abbrlink: 65b69107
date: 2023-10-31 21:40:19
tags:
  - nginx
categories: Network
top_img: "linear-gradient(60deg, rgba(0, 0, 255, 0.3), rgba(128, 0, 128, 0.6), rgba(204, 0, 102, 0.6), rgba(100, 40, 100, 0.6), rgba(190, 60, 160, 0.6))"
---

## 应用场景

- 静态资源服务-通过本地文件系统提供服务
- 反向代理服务-缓存、负载均衡
- `API`服务-`openresty`

## 什么是反向代理？

什么又是正向代理？

国内的客户想要直接访问 Google 官网是无法连接的，但如果该用户可以访问某服务器 A，而 A 可以访问 Google 官网，那么客户可以将此服务器 A 设置为代理服务器，借助 A 服务器请求获得 Google 的响应报文，再转发给用户。此时这个服务器 A 称之为正向代理服务器。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/20/172d07ea8b21370a~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp)

反向代理，客户是对代理无感知的。客户只需要向公开的 URL 向代理服务器发送请求，代理服务器再选择目标服务器处理请求并返回数据。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2020/6/20/172d07eec6f96cf3~tplv-t2oaga2asx-jj-mark:3024:0:0:0:q75.awebp)

总之：

- **`正向代理`，其实是`代理服务器`代理了`客户端`，去和`目标服务器`交互**
- **`反向代理`，`代理服务器`代理的是`目标服务器`，去和`客户端`交互**

## Nginx 如何处理请求

1. 接收请求：Nginx 作为服务器软件监听指定的端口，接收客户端发来的请求。

2. 解析请求：Nginx 解析请求的内容，包括请求方法（GET、POST 等）、URL、头部信息等。

3. 配置匹配：Nginx 根据配置文件中的规则和匹配条件，决定如何处理该请求。配置文件定义了`虚拟主机`、反向代理、负载均衡、缓存等特定的处理方式。

4. 处理请求：Nginx 根据配置的处理方式，可能会进行以下操作：

   - 静态文件服务：如果请求的是静态资源文件，如 HTML、CSS、JavaScript、图片等，Nginx 可以直接返回文件内容，不必经过后端应用程序。

   - 反向代理：如果配置了反向代理，Nginx 将请求转发给后端的应用服务器，然后将其响应返回给客户端。这样可以提供负载均衡、高可用性和缓存等功能。
   - 缓存：如果启用了缓存，Nginx 可以缓存一些静态或动态内容的响应，在后续相同的请求中直接返回缓存的响应，减少后端负载并提高响应速度。
   - URL 重写：Nginx 可以根据配置的规则对 URL 进行重写，将请求从一个 URL 重定向到另一个 URL 或进行转换。
   - SSL/TLS 加密：如果启用了 SSL/TLS，Nginx 可以负责加密和解密 HTTPS 请求和响应。
   - 访问控制：Nginx 可以根据配置的规则对请求进行访问控制，例如限制 IP 访问、进行身份认证等。

5. 响应结果：Nginx 根据处理结果生成响应报文，包括状态码、头部信息和响应内容。然后将响应发送给客户端。
